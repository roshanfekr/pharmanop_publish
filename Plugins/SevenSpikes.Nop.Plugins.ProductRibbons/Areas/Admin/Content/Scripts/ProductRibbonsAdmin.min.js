var ribbonType="",editRibbonPictureButtonElement="",pageRibbonTableSelector=".panel-group.page-ribbon";function setRibbonType(t){$(t).parents(".page-ribbon-settings").each(function(t,i){var e=$(i).attr("data-ribbontype");null!=e&&""!=e&&(ribbonType=e)})}function removeRibbonPictureFromDom(t){var i,e=getNoPlictureLableText();""!=e&&(i="<label>"+e+"</label>",$(t).html(i))}function removePictureId(){"category"==ribbonType&&null!=$("#CategoryPageRibbon_PictureId")&&$("#CategoryPageRibbon_PictureId").attr("value",0),"product"==ribbonType&&null!=$("#ProductPageRibbon_PictureId")&&$("#ProductPageRibbon_PictureId").attr("value",0)}function addAndDisplayRibbonPicturesGrid(){var t,e=$(".ribbonPicturesWindow").data("kendoWindow");null==e?$.ajax({url:$(".get-ribbon-picture-grid").attr("data-getGridUrl"),type:"GET"}).done(function(t){ribbonPictureGridHtml='<div class="ribbonPicturesWindow" style="opacity:0;"><div id="ribbon-pictures-grid">'+t+"</div></div>",$("body").prepend(ribbonPictureGridHtml),$(".ribbonPicturesWindow").kendoWindow({width:650,modal:!0,animation:!1}),(e=$(".ribbonPicturesWindow").data("kendoWindow")).center();var i=$(".ribbonPicturesWindow");i.css("opacity","100"),i.closest(".k-window").css("top","70px"),e.open(),$(document).on("click","#select-ribbon-images-grid tbody tr",function(t){var i=$(this).find("img").attr("alt");i&&addPictureIdToTheMarkup(i,$(this).find("img").attr("src"))})}):(e.center(),(t=$(".ribbonPicturesWindow")).css("opacity","100"),t.closest(".k-window").css("top","70px"),e.open())}function addPictureIdToTheMarkup(t,i){"category"==ribbonType&&null!=$("#CategoryPageRibbon_PictureId")&&setPictureId("#CategoryPageRibbon_PictureId",t,i),"product"==ribbonType&&null!=$("#ProductPageRibbon_PictureId")&&setPictureId("#ProductPageRibbon_PictureId",t,i)}function setPictureId(t,i,e){$(t).attr("value",i),$(".ribbonPicturesWindow").data("kendoWindow").close(),addPictureToDom(e,i),showDeleteRibbonPictureButton()}function showDeleteRibbonPictureButton(){var t=$(editRibbonPictureButtonElement).closest(".panel-group.page-ribbon").find(".remove-ribbon-picture");null!=t&&$(t).css("display","inline-block")}function addPictureToDom(t,i){var e,n,r=$(editRibbonPictureButtonElement);null==r||null!=(e=r.closest(".panel-group").find(".ribbon-image"))&&(n="<img src="+t+" alt="+i+" />",e.html(n))}function getRibbonPictureId(t){var i=$(t).attr("data-ribbonPictureId");return null!=i&&""!=i&&parseInt(i)||0}function getSetRibbonPictureUrl(){var t=$("#ribbon-data").attr("data-setRibbonPictureUrl");return null==t?"":t}function getNoPlictureLableText(){var t=$("#ribbon-data").attr("data-noPictureLabelText");return null==t?"":t}function getAddDeleteProductRibbonPictureUrl(t){var i=$(t).attr("data-addDeleteProductRibbonPictureUrl");return null==i?"":i}function getEditPictureUrl(t){var i=$(t).attr("data-editPictureUrl");return null==i||""==i?"":i}$(document).ready(function(){$(pageRibbonTableSelector).each(function(){var t=$(this).find(".ribbon-image label");null!=t&&0<t.length&&$(this).find(".remove-ribbon-picture").css("display","none")}),$("div.ribbon-picture-buttons .edit-ribbon-picture").click(function(){""!=getEditPictureUrl(this)&&(editRibbonPictureButtonElement=this,$(editRibbonPictureButtonElement).parents(".page-ribbon-settings").each(function(t,i){var e=$(i).attr("data-ribbontype");null!=e&&""!=e&&(ribbonType=e)}),addAndDisplayRibbonPicturesGrid())}),$("div.ribbon-picture-buttons .remove-ribbon-picture").on("click",function(){var t=$(this).closest(".panel-group").find("div.ribbon-image");null!=t&&null!=$(t).find("img")&&(setRibbonType(this),removePictureId(),removeRibbonPictureFromDom(t),$(this).css("display","none"))}),$(".manage-ribbon-pictures").click(function(){window.location.href=getAddDeleteProductRibbonPictureUrl(this)})});